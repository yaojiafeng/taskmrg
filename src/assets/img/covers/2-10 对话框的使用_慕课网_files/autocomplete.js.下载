define("common/js/autocomplete",["require"],function(){var t=null,e=-1,r="/learn/ajaxgetques";String.prototype.strLen=function(){for(var t=0,e=0;e<this.length;e++)this.charCodeAt(e)>255||this.charCodeAt(e)<0?t+=2:t++;return t},String.prototype.strToChars=function(){for(var t=new Array,e=0;e<this.length;e++)t[e]=[this.substr(e,1),this.isCHS(e)];return String.prototype.charsArray=t,t},String.prototype.isCHS=function(t){return this.charCodeAt(t)>255||this.charCodeAt(t)<0?!0:!1},String.prototype.subCHString=function(t,e){var r=0,a="";this.strToChars();for(var s=0;s<this.length;s++){if(this.charsArray[s][1]?r+=2:r++,r>e)return a;r>t&&(a+=this.charsArray[s][0])}return a},String.prototype.subCHStr=function(t,e){return this.subCHString(t,t+e)};var a=function(a){var s=a;t&&clearTimeout(t),t=setTimeout(function(){$.trim(s.val())?$.ajax({type:"get",url:r,dataType:"json",data:{words:$.trim(s.val()),cid:$("#w").data("cid")||OP_CONFIG.curCourse.id},success:function(t){if(0==t.result){e=-1;var r=t.data.data;if(r&&0!=r.length){var a="<dt>类似的问题</dt>";if(0!=r.length)for(var n=0;n<r.length;n++){var i=r[n],o=80,u=70,d=i.title||i.description,l=i.id,c=d.strLen()>o?d.subCHStr(0,u)+"..":d,h=i.answers,f="/learn/questiondetail/"+l+".html";"mk"==i.type&&(f="//www.imooc.com/qadetail/"+l);var m="";0!=i.finished&&(m="已采纳回答"),0!=i.last_t_id&&(m="老师回答"),0!=i.finished&&0!=i.last_t_id&&(m="老师回答 已采纳回答"),d=d.replace(/"/g,""),a+='<dd title="'+d+'"><a  class="questiontitle" target="_blank" href="'+f+'">'+c+"<em>"+h+"个回答</em> <i>"+m+"</i></a></dd>"}$(".send-area-result").html(a).css("z-index",99999).show(),s.attr("data-old",s.val())}else $(".send-area-result").hide().html("")}}}):$(".send-area-result").hide().html("")},400)},s=function(){var t=$(".send-area-result dd").removeClass("oncurr"),r="";e>-1&&(r=$(t.get(e)).addClass("oncurr").attr("title"))},n=function(){$(document).on({keydown:function(r){switch(t&&clearTimeout(t),r.keyCode){case 13:if(e>-1)return $(".send-area-result dd").eq(e).find("a")[0].click(),!1;var n=$.trim($(this).val());if(!n)return!1;$(".send-area-result").hide().html(""),e=-1;break;case 38:e=e>-1?e-1:$(".send-area-result dd").length-1,s();break;case 40:e=e<$(".send-area-result dd").length-1?e+1:-1,s();break;default:a($(this))}},focus:function(){$.trim($(this).val())&&a($(this))},blur:function(){setTimeout(function(){$(".send-area-result").hide().html("")},200)}},".autocomplete").on({mouseenter:function(){$(this).addClass("oncurr").siblings().removeClass("oncurr"),e=$(this).index()},mouseleave:function(){$(this).removeClass("oncurr"),e=-1}},".send-area-result dd")};n()});